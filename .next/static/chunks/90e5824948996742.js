(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3116,e=>{"use strict";let a=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>a],3116)},47627,e=>{"use strict";var a=e.i(43476),t=e.i(47163);function l({className:e,...l}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,t.cn)("w-full caption-bottom text-sm",e),...l})})}function s({className:e,...l}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,t.cn)("[&_tr]:border-b",e),...l})}function n({className:e,...l}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,t.cn)("[&_tr:last-child]:border-0",e),...l})}function i({className:e,...l}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,t.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...l})}function r({className:e,...l}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,t.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...l})}function o({className:e,...l}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,t.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...l})}e.s(["Table",()=>l,"TableBody",()=>n,"TableCell",()=>o,"TableHead",()=>r,"TableHeader",()=>s,"TableRow",()=>i])},78583,e=>{"use strict";let a=(0,e.i(75254).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>a],78583)},44303,e=>{"use strict";var a=e.i(43476),t=e.i(71645),l=e.i(67881),s=e.i(7233),n=e.i(30374),i=e.i(23750),r=e.i(10708),o=e.i(84762),c=e.i(62870),d=e.i(70065),u=e.i(47627),h=e.i(55436),m=e.i(88511),x=e.i(27612),j=e.i(26739),p=e.i(45740),g=e.i(974),v=e.i(87316),b=e.i(69638),N=e.i(3116),f=e.i(78583),C=e.i(66046);function w({consultations:e,onFilterClick:t,activeFilter:l}){let s=e.length,n=e.filter(e=>"Completada"===e.status).length,i=e.filter(e=>"Pendiente"===e.status).length,r=e.filter(e=>"En Proceso"===e.status).length,o=[{label:"Total Consultas",value:s,icon:f.FileText,color:"text-primary",filter:null,subtitle:"Registros totales"},{label:"Completadas",value:n,icon:b.CheckCircle,color:"text-green-500",filter:"Completada",subtitle:"Finalizadas exitosamente"},{label:"En Proceso",value:r,icon:N.Clock,color:"text-yellow-500",filter:"En Proceso",subtitle:"En atención actualmente"},{label:"Pendientes",value:i,icon:v.Calendar,color:"text-blue-500",filter:"Pendiente",subtitle:"Por atender"}];return(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:o.map(e=>{let s=e.icon,n=l===e.filter;return(0,a.jsx)(C.StatsCard,{label:e.label,value:e.value,icon:s,color:e.color,isActive:n,onClick:()=>t(e.filter),subtitle:e.subtitle},e.label)})})}var y=e.i(99508);function T(){let{user:e,selectedClinic:v,getUserId:b,getClinicId:N}=(0,j.useAuth)(),{showSuccess:f,showError:C,showWarning:T,AlertContainer:S}=(0,g.useAlertToast)(),[I,P]=(0,t.useState)([]),[L,F]=(0,t.useState)([]),[H,k]=(0,t.useState)([]),[B,E]=(0,t.useState)([]),[D,A]=(0,t.useState)(!1),[$,M]=(0,t.useState)(!1),[R,V]=(0,t.useState)(null),[q,O]=(0,t.useState)(""),[z,G]=(0,t.useState)(!0),[U,J]=(0,t.useState)(null),[K,_]=(0,t.useState)({patientId:"",patientName:"",ownerName:"",accompaniedBy:"",date:"",reason:"",diagnosis:"",treatment:"",notes:"",veterinarian:"",cost:""}),[X,Z]=(0,t.useState)({name:"",animalType:"",breed:"",age:"",weight:"",sex:"",ownerName:"",ownerPhone:"",medicalHistory:"",diseases:""});(0,t.useEffect)(()=>{e&&v&&(Q(),W(),Y())},[e,v]);let Q=async()=>{try{G(!0);let e=b(),a=N();if(!e||!a)return;let t=await fetch(`/api/consultations?userId=${e}&clinicId=${a}`),l=await t.json();l.success?P(l.data||[]):C(l.error||"Error al cargar consultas")}catch(e){console.error("Error fetching consultations:",e),C("Error al cargar las consultas")}finally{G(!1)}},W=async()=>{try{console.log("[v0] Fetching patients...");let e=b(),a=N();if(!e||!a)return void console.log("[v0] Missing userId or clinicId");console.log("[v0] Request params:",{userId:e,clinicId:a});let t=await fetch(`/api/patients?userId=${e}&clinicId=${a}`),l=await t.json();console.log("[v0] Patients API response:",l),l.success?(console.log("[v0] Patients loaded successfully:",l.data.length),F(l.data||[])):(console.log("[v0] API returned error:",l.error),T("No se pudieron cargar los pacientes"))}catch(e){console.error("[v0] Error fetching patients:",e),T("Error al cargar los pacientes")}},Y=async()=>{try{let e=b(),a=N();if(!e||!a)return;let t=await fetch(`/api/staff?userId=${e}&clinicId=${a}`),l=await t.json();if(l.success){let e=l.data.filter(e=>e.position&&e.position.toLowerCase().includes("veterinari"));k(e)}else T("No se pudieron cargar los veterinarios")}catch(e){console.error("Error fetching staff:",e)}};(0,t.useEffect)(()=>{ee()},[I,q,U]);let ee=()=>{let e=[...I];U&&(e=e.filter(e=>e.status===U)),q&&(e=e.filter(e=>e.patientName?.toLowerCase().includes(q.toLowerCase())||e.ownerName?.toLowerCase().includes(q.toLowerCase())||e.reason?.toLowerCase().includes(q.toLowerCase())||e.veterinarian?.toLowerCase().includes(q.toLowerCase()))),E(e)},ea=async e=>{if(e.preventDefault(),!K.patientName||!K.ownerName||!K.accompaniedBy||!K.date||!K.reason)return void T("Por favor completa todos los campos obligatorios");let a=b(),t=N(),l=R?"PUT":"POST",s=R?{...K,id:R.id,userId:a,clinicId:t}:{...K,userId:a,clinicId:t},n=await fetch("/api/consultations",{method:l,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),i=await n.json();i.success?(f(R?"Consulta actualizada exitosamente":"Consulta registrada exitosamente"),Q(),el()):C(i.error||"Error al guardar consulta")},et=async e=>{if(confirm("¿Estás seguro de eliminar esta consulta?")){let a=b(),t=N(),l=await fetch(`/api/consultations?id=${e}&userId=${a}&clinicId=${t}`,{method:"DELETE"});(await l.json()).success?(f("Consulta eliminada exitosamente"),Q()):C("Error al eliminar la consulta")}},el=()=>{A(!1),V(null),_({patientId:"",patientName:"",ownerName:"",accompaniedBy:"",date:"",reason:"",diagnosis:"",treatment:"",notes:"",veterinarian:"",cost:""})},es=async e=>{if(e.preventDefault(),!X.name||!X.animalType||!X.ownerName)return void T("Por favor completa los campos obligatorios del paciente");let a=b(),t=N(),l=await fetch("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...X,lastVisit:new Date().toISOString().split("T")[0],userId:a,clinicId:t})}),s=await l.json();s.success?(f("Paciente registrado exitosamente"),await W(),_({...K,patientId:s.data.id,patientName:s.data.name,ownerName:s.data.ownerName}),M(!1),Z({name:"",animalType:"",breed:"",age:"",weight:"",sex:"",ownerName:"",ownerPhone:"",medicalHistory:"",diseases:""})):C(s.error||"Error al registrar el paciente")},en=e=>{let{name:a,value:t}=e.target;_({...K,[a]:t})};return z?(0,a.jsx)(p.LoadingPage,{message:"Cargando consultas..."}):e&&v?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)(S,{}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Consultas"}),(0,a.jsxs)(l.Button,{onClick:()=>A(!0),children:[(0,a.jsx)(s.Plus,{className:"w-4 h-4 mr-2"}),"Nueva Consulta"]})]}),(0,a.jsx)(w,{consultations:I,onFilterClick:e=>{J(e)},activeFilter:U}),(0,a.jsxs)(d.Card,{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-4 mb-6",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(h.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,a.jsx)(i.Input,{placeholder:"Buscar por paciente, dueño, motivo o veterinario...",value:q,onChange:e=>O(e.target.value),className:"pl-10"})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(u.Table,{children:[(0,a.jsx)(u.TableHeader,{children:(0,a.jsxs)(u.TableRow,{children:[(0,a.jsx)(u.TableHead,{children:"ID"}),(0,a.jsx)(u.TableHead,{children:"Fecha"}),(0,a.jsx)(u.TableHead,{children:"Paciente"}),(0,a.jsx)(u.TableHead,{children:"Dueño"}),(0,a.jsx)(u.TableHead,{children:"Acompañante"}),(0,a.jsx)(u.TableHead,{children:"Motivo"}),(0,a.jsx)(u.TableHead,{children:"Diagnóstico"}),(0,a.jsx)(u.TableHead,{children:"Veterinario"}),(0,a.jsx)(u.TableHead,{children:"Costo"}),(0,a.jsx)(u.TableHead,{className:"text-right",children:"Acciones"})]})}),(0,a.jsx)(u.TableBody,{children:0===B.length?(0,a.jsx)(u.TableRow,{children:(0,a.jsx)(u.TableCell,{colSpan:10,className:"text-center text-muted-foreground",children:"No se encontraron consultas"})}):B.map(e=>(0,a.jsxs)(u.TableRow,{children:[(0,a.jsx)(u.TableCell,{className:"font-medium",children:e.id}),(0,a.jsx)(u.TableCell,{children:new Date(e.date).toLocaleDateString("es-MX")}),(0,a.jsx)(u.TableCell,{children:e.patientName}),(0,a.jsx)(u.TableCell,{children:e.ownerName}),(0,a.jsx)(u.TableCell,{children:e.accompaniedBy}),(0,a.jsx)(u.TableCell,{children:e.reason}),(0,a.jsx)(u.TableCell,{children:e.diagnosis||"-"}),(0,a.jsx)(u.TableCell,{children:e.veterinarian||"-"}),(0,a.jsx)(u.TableCell,{children:(0,y.formatCurrency)(e.cost||0)}),(0,a.jsx)(u.TableCell,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{V(e),_({...K,patientId:e.patientId||"",patientName:e.patientName||"",ownerName:e.ownerName||"",accompaniedBy:e.accompaniedBy||"",date:e.date?new Date(e.date).toISOString().split("T")[0]:"",reason:e.reason||"",diagnosis:e.diagnosis||"",treatment:e.treatment||"",notes:e.notes||"",veterinarian:e.veterinarian||"",cost:e.cost||""}),A(!0)},children:(0,a.jsx)(m.Edit,{className:"w-4 h-4"})}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>et(e.id),children:(0,a.jsx)(x.Trash2,{className:"w-4 h-4 text-destructive"})})]})})]},e.id))})]})})]}),(0,a.jsx)(n.Dialog,{open:D,onOpenChange:A,children:(0,a.jsxs)(n.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(n.DialogHeader,{children:(0,a.jsx)(n.DialogTitle,{children:R?"Editar Consulta":"Nueva Consulta"})}),(0,a.jsxs)("form",{onSubmit:ea,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(r.Label,{children:"Paciente *"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.Select,{value:K.patientId,onValueChange:e=>{console.log("[v0] Patient selected:",e),console.log("[v0] Available patients:",L);let a=L.find(a=>a.id===Number.parseInt(e));console.log("[v0] Found patient:",a),a?(_({...K,patientId:a.id,patientName:a.name,ownerName:a.ownerName}),console.log("[v0] Form data updated with patient info")):console.log("[v0] Patient not found in list")},children:[(0,a.jsx)(c.SelectTrigger,{children:(0,a.jsx)(c.SelectValue,{placeholder:"Seleccionar paciente"})}),(0,a.jsx)(c.SelectContent,{children:L.map(e=>(0,a.jsxs)(c.SelectItem,{value:e.id.toString(),children:[e.name," - ",e.ownerName]},e.id))})]}),(0,a.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>M(!0),children:"Nuevo Paciente"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"patientName",children:"Nombre del Paciente *"}),(0,a.jsx)(i.Input,{id:"patientName",name:"patientName",value:K.patientName,onChange:en,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"ownerName",children:"Nombre del Dueño *"}),(0,a.jsx)(i.Input,{id:"ownerName",name:"ownerName",value:K.ownerName,onChange:en,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"accompaniedBy",children:"Acompañado por *"}),(0,a.jsx)(i.Input,{id:"accompaniedBy",name:"accompaniedBy",value:K.accompaniedBy,onChange:en,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"date",children:"Fecha *"}),(0,a.jsx)(i.Input,{id:"date",name:"date",type:"date",value:K.date,onChange:en,required:!0})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(r.Label,{htmlFor:"reason",children:"Motivo de la Consulta *"}),(0,a.jsx)(o.Textarea,{id:"reason",name:"reason",value:K.reason,onChange:en,required:!0})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(r.Label,{htmlFor:"diagnosis",children:"Diagnóstico"}),(0,a.jsx)(o.Textarea,{id:"diagnosis",name:"diagnosis",value:K.diagnosis,onChange:en})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(r.Label,{htmlFor:"treatment",children:"Tratamiento"}),(0,a.jsx)(o.Textarea,{id:"treatment",name:"treatment",value:K.treatment,onChange:en})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(r.Label,{htmlFor:"notes",children:"Notas Adicionales"}),(0,a.jsx)(o.Textarea,{id:"notes",name:"notes",value:K.notes,onChange:en})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"veterinarian",children:"Veterinario"}),(0,a.jsxs)(c.Select,{value:K.veterinarian,onValueChange:e=>_({...K,veterinarian:e}),children:[(0,a.jsx)(c.SelectTrigger,{children:(0,a.jsx)(c.SelectValue,{placeholder:"Seleccionar veterinario"})}),(0,a.jsxs)(c.SelectContent,{children:[(0,a.jsx)(c.SelectItem,{value:"none",children:"Ninguno"}),H.map(e=>(0,a.jsxs)(c.SelectItem,{value:`${e.name} ${e.lastName}`,children:[e.name," ",e.lastName," - ",e.position]},e.id))]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"cost",children:"Costo"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),(0,a.jsx)(i.Input,{id:"cost",name:"cost",value:K.cost,onChange:e=>{let a=(0,y.parseCurrency)(e.target.value);(""===a||/^\d*\.?\d{0,2}$/.test(a))&&_({...K,cost:a})},placeholder:"0.00",className:"pl-7"})]}),K.cost&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,y.formatCurrency)(K.cost)})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(l.Button,{type:"button",variant:"outline",onClick:el,children:"Cancelar"}),(0,a.jsx)(l.Button,{type:"submit",children:R?"Actualizar":"Guardar"})]})]})]})}),(0,a.jsx)(n.Dialog,{open:$,onOpenChange:M,children:(0,a.jsxs)(n.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(n.DialogHeader,{children:(0,a.jsx)(n.DialogTitle,{children:"Registrar Nuevo Paciente"})}),(0,a.jsxs)("form",{onSubmit:es,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"name",children:"Nombre *"}),(0,a.jsx)(i.Input,{id:"name",value:X.name,onChange:e=>Z({...X,name:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"animalType",children:"Tipo de Animal *"}),(0,a.jsxs)(c.Select,{value:X.animalType,onValueChange:e=>Z({...X,animalType:e}),children:[(0,a.jsx)(c.SelectTrigger,{children:(0,a.jsx)(c.SelectValue,{placeholder:"Seleccionar"})}),(0,a.jsxs)(c.SelectContent,{children:[(0,a.jsx)(c.SelectItem,{value:"Perro",children:"Perro"}),(0,a.jsx)(c.SelectItem,{value:"Gato",children:"Gato"}),(0,a.jsx)(c.SelectItem,{value:"Ave",children:"Ave"}),(0,a.jsx)(c.SelectItem,{value:"Conejo",children:"Conejo"}),(0,a.jsx)(c.SelectItem,{value:"Hamster",children:"Hámster"}),(0,a.jsx)(c.SelectItem,{value:"Reptil",children:"Reptil"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"breed",children:"Raza"}),(0,a.jsx)(i.Input,{id:"breed",value:X.breed,onChange:e=>Z({...X,breed:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"age",children:"Edad (años)"}),(0,a.jsx)(i.Input,{id:"age",value:X.age,onChange:e=>{(""===e.target.value||/^\d+$/.test(e.target.value))&&Z({...X,age:e.target.value})}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"weight",children:"Peso (kg)"}),(0,a.jsx)(i.Input,{id:"weight",value:X.weight,onChange:e=>{(""===e.target.value||/^\d*\.?\d*$/.test(e.target.value))&&Z({...X,weight:e.target.value})}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"sex",children:"Sexo"}),(0,a.jsxs)(c.Select,{value:X.sex,onValueChange:e=>Z({...X,sex:e}),children:[(0,a.jsx)(c.SelectTrigger,{children:(0,a.jsx)(c.SelectValue,{placeholder:"Seleccionar"})}),(0,a.jsxs)(c.SelectContent,{children:[(0,a.jsx)(c.SelectItem,{value:"Macho",children:"Macho"}),(0,a.jsx)(c.SelectItem,{value:"Hembra",children:"Hembra"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"ownerName",children:"Nombre del Dueño *"}),(0,a.jsx)(i.Input,{id:"ownerName",value:X.ownerName,onChange:e=>Z({...X,ownerName:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Label,{htmlFor:"ownerPhone",children:"Teléfono del Dueño"}),(0,a.jsx)(i.Input,{id:"ownerPhone",value:X.ownerPhone,onChange:e=>Z({...X,ownerPhone:e.target.value})})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(r.Label,{htmlFor:"medicalHistory",children:"Historial Médico"}),(0,a.jsx)(o.Textarea,{id:"medicalHistory",value:X.medicalHistory,onChange:e=>Z({...X,medicalHistory:e.target.value})})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)(r.Label,{htmlFor:"diseases",children:"Enfermedades"}),(0,a.jsx)(o.Textarea,{id:"diseases",value:X.diseases,onChange:e=>Z({...X,diseases:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>M(!1),children:"Cancelar"}),(0,a.jsx)(l.Button,{type:"submit",children:"Guardar Paciente"})]})]})]})})]}):(0,a.jsx)("div",{className:"p-6",children:"Por favor selecciona un consultorio"})}e.s(["default",()=>T],44303)}]);