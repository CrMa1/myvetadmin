{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Proyectos/Veterinarios/myvetadmin/lib/db.js"],"sourcesContent":["import mysql from \"mysql2/promise\"\n\n\n// Configuración de la conexión a la base de datos\nconst dbConfig = {\n  host: process.env.DB_HOST || \"174.136.31.150\",\n  user: process.env.DB_USER || \"mavishop_myvetadmin\",\n  password: process.env.DB_PASSWORD || \"KDZ-2y_O#cmI^v7r\",\n  database: process.env.DB_NAME || \"mavishop_myvetadmin\",\n  waitForConnections: true,\n  connectionLimit: 10,\n  queueLimit: 0,\n  enableKeepAlive: true,\n  keepAliveInitialDelay: 0,\n}\n\n// Pool de conexiones para mejor rendimiento\nlet pool\n\nexport async function getConnection() {\n  if (!pool) {\n    pool = mysql.createPool(dbConfig)\n  }\n  return pool\n}\n\nexport async function query(sql, params) {\n  //console.log(\"[v0] Query params:\", params)\n  \n  const connection = await getConnection()\n  try {\n    const [results] = await connection.execute(sql, params)\n    //console.log(\"[v0] Query successful, rows returned:\", Array.isArray(results) ? results.length : \"single result\")\n    return results\n  } catch (error) {\n    console.error(\"[v0] Database query error - Full details:\")\n    console.error(\"[v0] Query:\", sql)\n    console.error(\"[v0] Params:\", params)\n    console.error(\"[v0] Error message:\", error.message)\n    console.error(\"[v0] Error code:\", error.code)\n    console.error(\"[v0] Error sqlState:\", error.sqlState)\n    console.error(\"[v0] Error:\", error)\n    throw error\n  }\n}\n\nexport default { getConnection, query }\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGA,kDAAkD;AAClD,MAAM,WAAW;IACf,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;IACZ,iBAAiB;IACjB,uBAAuB;AACzB;AAEA,4CAA4C;AAC5C,IAAI;AAEG,eAAe;IACpB,IAAI,CAAC,MAAM;QACT,OAAO,8IAAK,CAAC,UAAU,CAAC;IAC1B;IACA,OAAO;AACT;AAEO,eAAe,MAAM,GAAG,EAAE,MAAM;IACrC,2CAA2C;IAE3C,MAAM,aAAa,MAAM;IACzB,IAAI;QACF,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,OAAO,CAAC,KAAK;QAChD,iHAAiH;QACjH,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,QAAQ,KAAK,CAAC,eAAe;QAC7B,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,QAAQ,KAAK,CAAC,uBAAuB,MAAM,OAAO;QAClD,QAAQ,KAAK,CAAC,oBAAoB,MAAM,IAAI;QAC5C,QAAQ,KAAK,CAAC,wBAAwB,MAAM,QAAQ;QACpD,QAAQ,KAAK,CAAC,eAAe;QAC7B,MAAM;IACR;AACF;uCAEe;IAAE;IAAe;AAAM","debugId":null}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///C:/Proyectos/Veterinarios/myvetadmin/app/api/profile/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { query } from \"@/lib/db\"\nimport bcrypt from \"bcryptjs\"\n\nexport async function GET(request) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const userId = searchParams.get(\"userId\")\n\n    if (!userId) {\n      return NextResponse.json({ success: false, error: \"ID de usuario requerido\" }, { status: 400 })\n    }\n\n    const users = await query(\"SELECT id, name, email, role, phone, created_at FROM users WHERE id = ?\", [userId])\n\n    if (users.length === 0) {\n      return NextResponse.json({ success: false, error: \"Usuario no encontrado\" }, { status: 404 })\n    }\n\n    return NextResponse.json({ success: true, data: users[0] })\n  } catch (error) {\n    console.error(\"Get profile error:\", error)\n    return NextResponse.json({ success: false, error: \"Error al obtener perfil\" }, { status: 500 })\n  }\n}\n\nexport async function PUT(request) {\n  try {\n    const data = await request.json()\n\n    if (!data.id) {\n      return NextResponse.json({ success: false, error: \"ID de usuario requerido\" }, { status: 400 })\n    }\n\n    const updateFields = []\n    const updateValues = []\n\n    if (data.name) {\n      updateFields.push(\"name = ?\")\n      updateValues.push(data.name)\n    }\n    if (data.email) {\n      updateFields.push(\"email = ?\")\n      updateValues.push(data.email)\n    }\n    if (data.phone) {\n      updateFields.push(\"phone = ?\")\n      updateValues.push(data.phone)\n    }\n    if (data.password) {\n      const hashedPassword = await bcrypt.hash(data.password, 10)\n      updateFields.push(\"password = ?\")\n      updateValues.push(hashedPassword)\n    }\n\n    if (updateFields.length === 0) {\n      return NextResponse.json({ success: false, error: \"No hay campos para actualizar\" }, { status: 400 })\n    }\n\n    updateValues.push(data.id)\n\n    await query(`UPDATE users SET ${updateFields.join(\", \")} WHERE id = ?`, updateValues)\n\n    const updatedUsers = await query(\"SELECT id, name, email, role, phone, created_at FROM users WHERE id = ?\", [\n      data.id,\n    ])\n\n    return NextResponse.json({ success: true, data: updatedUsers[0] })\n  } catch (error) {\n    console.error(\"Update profile error:\", error)\n    return NextResponse.json({ success: false, error: \"Error al actualizar perfil\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAO;IAC/B,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;QAEhC,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/F;QAEA,MAAM,QAAQ,MAAM,IAAA,oHAAK,EAAC,2EAA2E;YAAC;SAAO;QAE7G,IAAI,MAAM,MAAM,KAAK,GAAG;YACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC7F;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM,KAAK,CAAC,EAAE;QAAC;IAC3D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAA0B,GAAG;YAAE,QAAQ;QAAI;IAC/F;AACF;AAEO,eAAe,IAAI,OAAO;IAC/B,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,IAAI,CAAC,KAAK,EAAE,EAAE;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/F;QAEA,MAAM,eAAe,EAAE;QACvB,MAAM,eAAe,EAAE;QAEvB,IAAI,KAAK,IAAI,EAAE;YACb,aAAa,IAAI,CAAC;YAClB,aAAa,IAAI,CAAC,KAAK,IAAI;QAC7B;QACA,IAAI,KAAK,KAAK,EAAE;YACd,aAAa,IAAI,CAAC;YAClB,aAAa,IAAI,CAAC,KAAK,KAAK;QAC9B;QACA,IAAI,KAAK,KAAK,EAAE;YACd,aAAa,IAAI,CAAC;YAClB,aAAa,IAAI,CAAC,KAAK,KAAK;QAC9B;QACA,IAAI,KAAK,QAAQ,EAAE;YACjB,MAAM,iBAAiB,MAAM,8IAAM,CAAC,IAAI,CAAC,KAAK,QAAQ,EAAE;YACxD,aAAa,IAAI,CAAC;YAClB,aAAa,IAAI,CAAC;QACpB;QAEA,IAAI,aAAa,MAAM,KAAK,GAAG;YAC7B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAgC,GAAG;gBAAE,QAAQ;YAAI;QACrG;QAEA,aAAa,IAAI,CAAC,KAAK,EAAE;QAEzB,MAAM,IAAA,oHAAK,EAAC,CAAC,iBAAiB,EAAE,aAAa,IAAI,CAAC,MAAM,aAAa,CAAC,EAAE;QAExE,MAAM,eAAe,MAAM,IAAA,oHAAK,EAAC,2EAA2E;YAC1G,KAAK,EAAE;SACR;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM,YAAY,CAAC,EAAE;QAAC;IAClE,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClG;AACF","debugId":null}}]
}