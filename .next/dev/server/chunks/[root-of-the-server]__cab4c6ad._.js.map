{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Proyectos/Veterinarios/myvetadmin/lib/db.js"],"sourcesContent":["import mysql from \"mysql2/promise\"\n\n\n// Configuración de la conexión a la base de datos\nconst dbConfig = {\n  host: process.env.DB_HOST || \"174.136.31.150\",\n  user: process.env.DB_USER || \"mavishop_myvetadmin\",\n  password: process.env.DB_PASSWORD || \"KDZ-2y_O#cmI^v7r\",\n  database: process.env.DB_NAME || \"mavishop_myvetadmin\",\n  waitForConnections: true,\n  connectionLimit: 10,\n  queueLimit: 0,\n  enableKeepAlive: true,\n  keepAliveInitialDelay: 0,\n}\n\n// Pool de conexiones para mejor rendimiento\nlet pool\n\nexport async function getConnection() {\n  if (!pool) {\n    pool = mysql.createPool(dbConfig)\n  }\n  return pool\n}\n\nexport async function query(sql, params) {\n  //console.log(\"[v0] Query params:\", params)\n  \n  const connection = await getConnection()\n  try {\n    const [results] = await connection.execute(sql, params)\n    //console.log(\"[v0] Query successful, rows returned:\", Array.isArray(results) ? results.length : \"single result\")\n    return results\n  } catch (error) {\n    //console.error(\"[v0] Database query error - Full details:\")\n    //console.error(\"[v0] Query:\", sql)\n    //console.error(\"[v0] Params:\", params)\n    //console.error(\"[v0] Error message:\", error.message)\n    //console.error(\"[v0] Error code:\", error.code)\n    //console.error(\"[v0] Error sqlState:\", error.sqlState)\n    //console.error(\"[v0] Error:\", error)\n    throw error\n  }\n}\n\nexport default { getConnection, query }\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGA,kDAAkD;AAClD,MAAM,WAAW;IACf,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;IACZ,iBAAiB;IACjB,uBAAuB;AACzB;AAEA,4CAA4C;AAC5C,IAAI;AAEG,eAAe;IACpB,IAAI,CAAC,MAAM;QACT,OAAO,8IAAK,CAAC,UAAU,CAAC;IAC1B;IACA,OAAO;AACT;AAEO,eAAe,MAAM,GAAG,EAAE,MAAM;IACrC,2CAA2C;IAE3C,MAAM,aAAa,MAAM;IACzB,IAAI;QACF,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,OAAO,CAAC,KAAK;QAChD,iHAAiH;QACjH,OAAO;IACT,EAAE,OAAO,OAAO;QACd,4DAA4D;QAC5D,mCAAmC;QACnC,uCAAuC;QACvC,qDAAqD;QACrD,+CAA+C;QAC/C,uDAAuD;QACvD,qCAAqC;QACrC,MAAM;IACR;AACF;uCAEe;IAAE;IAAe;AAAM","debugId":null}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///C:/Proyectos/Veterinarios/myvetadmin/app/api/auth/validate/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\nimport { query } from \"@/lib/db\"\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const { email, phone } = await request.json()\r\n\r\n    console.log(\"[v0] Validating email and phone:\", { email, phone })\r\n\r\n    const validationErrors = []\r\n\r\n    // Verificar si el email ya existe\r\n    if (email) {\r\n      const existingEmailUsers = await query(\"SELECT id FROM users WHERE email = ?\", [email])\r\n      if (existingEmailUsers.length > 0) {\r\n        validationErrors.push({ field: \"email\", message: \"Este correo electrónico ya está registrado\" })\r\n      }\r\n    }\r\n\r\n    // Verificar si el teléfono ya existe\r\n    if (phone) {\r\n      const existingPhoneUsers = await query(\"SELECT id FROM users WHERE phone = ?\", [phone])\r\n      if (existingPhoneUsers.length > 0) {\r\n        validationErrors.push({ field: \"phone\", message: \"Este número de teléfono ya está registrado\" })\r\n      }\r\n    }\r\n\r\n    if (validationErrors.length > 0) {\r\n      return NextResponse.json({ success: false, errors: validationErrors }, { status: 400 })\r\n    }\r\n\r\n    return NextResponse.json({ success: true, message: \"Validación exitosa\" })\r\n  } catch (error) {\r\n    console.error(\"[v0] Validation error:\", error)\r\n    return NextResponse.json({ success: false, error: \"Error al validar datos\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE3C,QAAQ,GAAG,CAAC,oCAAoC;YAAE;YAAO;QAAM;QAE/D,MAAM,mBAAmB,EAAE;QAE3B,kCAAkC;QAClC,IAAI,OAAO;YACT,MAAM,qBAAqB,MAAM,IAAA,oHAAK,EAAC,wCAAwC;gBAAC;aAAM;YACtF,IAAI,mBAAmB,MAAM,GAAG,GAAG;gBACjC,iBAAiB,IAAI,CAAC;oBAAE,OAAO;oBAAS,SAAS;gBAA6C;YAChG;QACF;QAEA,qCAAqC;QACrC,IAAI,OAAO;YACT,MAAM,qBAAqB,MAAM,IAAA,oHAAK,EAAC,wCAAwC;gBAAC;aAAM;YACtF,IAAI,mBAAmB,MAAM,GAAG,GAAG;gBACjC,iBAAiB,IAAI,CAAC;oBAAE,OAAO;oBAAS,SAAS;gBAA6C;YAChG;QACF;QAEA,IAAI,iBAAiB,MAAM,GAAG,GAAG;YAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,QAAQ;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACvF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,SAAS;QAAqB;IAC1E,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAC9F;AACF","debugId":null}}]
}