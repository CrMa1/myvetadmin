module.exports=[84140,a=>{"use strict";var b=a.i(87924),c=a.i(15618),d=a.i(40695),e=a.i(3130),f=a.i(5522),g=a.i(54161),h=a.i(72131),i=a.i(87532),j=a.i(24569),k=a.i(81560),l=a.i(92258),m=a.i(63519),n=a.i(33508),o=a.i(56711),p=a.i(33575),q=a.i(65733),r=a.i(17171),s=a.i(87682);function t({staff:a,onAdd:c,onEdit:t,onDelete:u,filterPosition:v,onClearFilter:w}){let[x,y]=(0,h.useState)(""),[z,A]=(0,h.useState)(!1),[B,C]=(0,h.useState)(!1),[D,E]=(0,h.useState)(!1),[F,G]=(0,h.useState)(null),[H,I]=(0,h.useState)({firstName:"",lastName:"",position:"",email:"",phone:"",license:"",salary:""}),J=(0,h.useMemo)(()=>{let b=a;if(v&&(b=b.filter(a=>a.position===v)),x){let a=x.toLowerCase();b=b.filter(b=>b.firstName.toLowerCase().includes(a)||b.lastName.toLowerCase().includes(a)||b.position.toLowerCase().includes(a)||b.email.toLowerCase().includes(a)||b.id.toLowerCase().includes(a))}return b},[a,x,v]),K=()=>{I({firstName:"",lastName:"",position:"",email:"",phone:"",license:"",salary:""})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{children:"Lista de Personal"}),(0,b.jsx)(e.CardDescription,{children:"Todos los empleados registrados en el sistema"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[v&&(0,b.jsxs)(d.Button,{variant:"outline",size:"sm",onClick:w,children:[(0,b.jsx)(n.X,{className:"h-4 w-4 mr-2"}),"Limpiar filtro"]}),(0,b.jsxs)("div",{className:"relative w-64",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(f.Input,{type:"search",placeholder:"Buscar personal...",className:"pl-10",value:x,onChange:a=>y(a.target.value)})]})]})]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"rounded-lg border border-border overflow-hidden",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-muted/50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"ID"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Nombre"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Puesto"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Contacto"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Licencia"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Salario"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Fecha Ingreso"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Acciones"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-border",children:J.map(a=>{let c=new Date(a.hireDate),e=Math.floor((Date.now()-c.getTime())/31536e6);return(0,b.jsxs)("tr",{className:"hover:bg-muted/30 transition-colors",children:[(0,b.jsx)("td",{className:"px-4 py-3 text-sm font-mono text-muted-foreground",children:a.id}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:`${a.firstName} ${a.lastName}`}),e>0&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e," años en la clínica"]})]})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(g.Badge,{variant:{Veterinario:"default","Asistente Médico":"secondary",Recepcionista:"outline",Técnico:"secondary"}[a.position]||"outline",children:a.position})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,b.jsx)(l.Mail,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-xs",children:a.email})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,b.jsx)(m.Phone,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-xs",children:a.phone})]})]})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("p",{className:"text-sm font-mono",children:a.license})}),(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsxs)("p",{className:"text-sm font-medium",children:["$",a.salary.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"mensual"})]}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("p",{className:"text-sm",children:(0,o.format)(c,"dd MMM yyyy",{locale:p.es})})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{G(a),I({firstName:a.firstName,lastName:a.lastName,position:a.position,email:a.email,phone:a.phone,license:a.license||"",salary:a.salary.toString()}),C(!0)},children:(0,b.jsx)(j.Edit,{className:"h-4 w-4"})}),(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>{G(a),E(!0)},children:(0,b.jsx)(k.Trash2,{className:"h-4 w-4"})})]})})]},a.id)})})]})})}),0===J.length&&(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No se encontró personal"})}),(0,b.jsx)("div",{className:"mt-4 flex items-center justify-between text-sm text-muted-foreground",children:(0,b.jsxs)("p",{children:["Mostrando ",J.length," de ",a.length," empleados"]})})]})]}),(0,b.jsx)(q.Dialog,{open:z||B,onOpenChange:a=>{a||(A(!1),C(!1),K(),G(null))},children:(0,b.jsxs)(q.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(q.DialogHeader,{children:[(0,b.jsx)(q.DialogTitle,{children:z?"Nuevo Empleado":"Editar Empleado"}),(0,b.jsx)(q.DialogDescription,{children:z?"Complete los datos del nuevo empleado":"Modifique los datos del empleado"})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"firstName",children:["Nombre ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(f.Input,{id:"firstName",value:H.firstName,onChange:a=>I({...H,firstName:a.target.value}),placeholder:"Ej: Juan"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"lastName",children:["Apellido ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(f.Input,{id:"lastName",value:H.lastName,onChange:a=>I({...H,lastName:a.target.value}),placeholder:"Ej: Pérez"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"position",children:["Puesto ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)(s.Select,{value:H.position,onValueChange:a=>I({...H,position:a}),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{placeholder:"Seleccione"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"Veterinario",children:"Veterinario"}),(0,b.jsx)(s.SelectItem,{value:"Asistente Médico",children:"Asistente Médico"}),(0,b.jsx)(s.SelectItem,{value:"Recepcionista",children:"Recepcionista"}),(0,b.jsx)(s.SelectItem,{value:"Técnico",children:"Técnico"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"email",children:["Email ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(f.Input,{id:"email",type:"email",value:H.email,onChange:a=>I({...H,email:a.target.value}),placeholder:"ejemplo@correo.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"phone",children:["Teléfono ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(f.Input,{id:"phone",value:H.phone,onChange:a=>I({...H,phone:a.target.value}),placeholder:"55-1234-5678"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"license",children:"Licencia Profesional"}),(0,b.jsx)(f.Input,{id:"license",value:H.license,onChange:a=>I({...H,license:a.target.value}),placeholder:"Ej: VET-12345"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(r.Label,{htmlFor:"salary",children:["Salario Mensual ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(f.Input,{id:"salary",type:"number",min:"0",value:H.salary,onChange:a=>I({...H,salary:a.target.value}),onKeyPress:a=>{/[0-9]/.test(a.key)||a.preventDefault()},placeholder:"Ej: 15000"})]})]})]}),(0,b.jsxs)(q.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{A(!1),C(!1),K(),G(null)},children:"Cancelar"}),(0,b.jsx)(d.Button,{onClick:z?()=>{H.firstName&&H.lastName&&H.position&&H.email&&H.phone&&H.salary?(c({id:`EMP-${Math.floor(9e3*Math.random())+1e3}`,...H,salary:Number.parseInt(H.salary),hireDate:new Date().toISOString()}),A(!1),K()):alert("Por favor complete todos los campos obligatorios")}:()=>{H.firstName&&H.lastName&&H.position&&H.email&&H.phone&&H.salary?(t({...F,...H,salary:Number.parseInt(H.salary)}),C(!1),K(),G(null)):alert("Por favor complete todos los campos obligatorios")},children:z?"Agregar":"Guardar Cambios"})]})]})}),(0,b.jsx)(q.Dialog,{open:D,onOpenChange:E,children:(0,b.jsxs)(q.DialogContent,{children:[(0,b.jsxs)(q.DialogHeader,{children:[(0,b.jsx)(q.DialogTitle,{children:"Confirmar Eliminación"}),(0,b.jsxs)(q.DialogDescription,{children:["¿Está seguro que desea eliminar a"," ",(0,b.jsxs)("strong",{children:[F?.firstName," ",F?.lastName]}),"? Esta acción no se puede deshacer."]})]}),(0,b.jsxs)(q.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>E(!1),children:"Cancelar"}),(0,b.jsx)(d.Button,{variant:"destructive",onClick:()=>{F&&(u(F.id),E(!1),G(null))},children:"Eliminar"})]})]})})]})}var u=a.i(17493),v=a.i(3183),w=a.i(19966),x=a.i(1484),y=a.i(60246),z=a.i(35126);let A=(0,a.i(70106).default)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var B=a.i(90166),C=a.i(86297);function D(){let{user:a,selectedClinic:e,getUserId:g,getClinicId:i}=(0,v.useAuth)(),{showSuccess:j,showError:k,showWarning:l,showInfo:m,AlertContainer:n}=(0,x.useAlertToast)(),[o,p]=(0,h.useState)([]),[D,E]=(0,h.useState)([]),[F,G]=(0,h.useState)([]),[H,I]=(0,h.useState)(!0),[J,K]=(0,h.useState)(!1),[L,M]=(0,h.useState)(null),[N,O]=(0,h.useState)(null),[P,Q]=(0,h.useState)({name:"",lastName:"",position:"",email:"",phone:"",salary:"",license:""});(0,h.useEffect)(()=>{a&&e&&(R(),S())},[a,e]);let R=async()=>{try{I(!0);let a=g(),b=i();if(!a||!b)return;let c=await fetch(`/api/staff?userId=${a}&clinicId=${b}`),d=await c.json();d.success?(p(d.data||[]),E(d.data||[])):k(d.error||"Error al cargar el personal")}catch(a){console.error("Error fetching staff:",a),k("Error al cargar el personal")}finally{I(!1)}},S=async()=>{try{let a=await fetch("/api/positions"),b=await a.json();b.success?G(b.data):l("No se pudieron cargar los puestos")}catch(a){console.error("Error fetching positions:",a)}},T=async a=>{if(confirm("¿Estás seguro de eliminar este empleado?"))try{let b=g(),c=i(),d=await fetch(`/api/staff?id=${a}&userId=${b}&clinicId=${c}`,{method:"DELETE"}),e=await d.json();e.success?(j("Empleado eliminado exitosamente"),await R()):k(e.error||"Error al eliminar el empleado")}catch(a){console.error("Error deleting staff:",a),k("Error al eliminar el empleado")}},U=async a=>{if(a.preventDefault(),!P.name||!P.lastName||!P.position)return void l("Por favor completa todos los campos requeridos");try{let a=g(),b=i(),c=L?"PUT":"POST",d=L?{name:P.name,lastName:P.lastName,positionId:P.position,email:P.email,phone:P.phone,salary:P.salary,license:P.license,id:L.id,userId:a,clinicId:b}:{name:P.name,lastName:P.lastName,positionId:P.position,email:P.email,phone:P.phone,salary:P.salary,license:P.license,userId:a,clinicId:b},e=await fetch("/api/staff",{method:c,headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),f=await e.json();f.success?(j(L?"Empleado actualizado exitosamente":"Empleado agregado exitosamente"),K(!1),await R()):k(f.error||"Error al guardar el empleado")}catch(a){console.error("Error saving staff:",a),k("Error al guardar el empleado")}},V=(a,b)=>{Q(c=>({...c,[a]:b}))},W=a=>{O(a),a?E(o.filter(b=>b.position===a)):E(o)};if(H)return(0,b.jsx)(w.LoadingPage,{message:"Cargando personal..."});if(!a||!e)return(0,b.jsx)("div",{className:"p-8",children:"Por favor selecciona un consultorio"});let X=o.length,Y=o.filter(a=>"Veterinario"===a.position).length,Z=o.filter(a=>"Activo"===a.status).length,$=o.reduce((a,b)=>a+(Number.parseFloat(b.salary)||0),0);return(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsx)(n,{}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Personal"}),(0,b.jsxs)(d.Button,{onClick:()=>{M(null),Q({name:"",lastName:"",position:"",email:"",phone:"",salary:"",license:""}),K(!0)},className:"btn-primary",children:[(0,b.jsx)(c.Plus,{className:"w-4 h-4 mr-2"}),"Nuevo Empleado"]})]}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[(0,b.jsx)(u.StatsCard,{title:"Total de Empleados",subtitle:"Personal registrado",value:X,icon:y.Users,trend:{value:0,isPositive:!0},onClick:()=>W(null),isActive:null===N}),(0,b.jsx)(u.StatsCard,{title:"Veterinarios",subtitle:"Personal médico",value:Y,icon:z.Stethoscope,trend:{value:0,isPositive:!0},onClick:()=>W("Veterinario"),isActive:"Veterinario"===N}),(0,b.jsx)(u.StatsCard,{title:"Personal Activo",subtitle:"Empleados activos",value:Z,icon:A,trend:{value:0,isPositive:!0}}),(0,b.jsx)(u.StatsCard,{title:"Nómina Total",subtitle:"Gasto mensual",value:(0,C.formatCurrency)($),icon:B.DollarSign,trend:{value:0,isPositive:!0}})]}),(0,b.jsx)(t,{staff:D,onEdit:a=>{M(a),Q({name:a.name||"",lastName:a.lastName||"",position:a.position||"",email:a.email||"",phone:a.phone||"",salary:a.salary||"",license:a.license||""}),K(!0)},onDelete:T,onSearch:a=>{E(o.filter(b=>b.name.toLowerCase().includes(a.toLowerCase())||b.lastName.toLowerCase().includes(a.toLowerCase())||b.position.toLowerCase().includes(a.toLowerCase())))}}),(0,b.jsx)(q.Dialog,{open:J,onOpenChange:K,children:(0,b.jsxs)(q.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(q.DialogHeader,{children:(0,b.jsx)(q.DialogTitle,{children:L?"Editar Empleado":"Agregar Nuevo Empleado"})}),(0,b.jsxs)("form",{onSubmit:U,className:"grid gap-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:"name",children:"Nombre *"}),(0,b.jsx)(f.Input,{id:"name",value:P.name,onChange:a=>V("name",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:"lastName",children:"Apellido *"}),(0,b.jsx)(f.Input,{id:"lastName",value:P.lastName,onChange:a=>V("lastName",a.target.value),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:"position",children:"Puesto *"}),(0,b.jsxs)(s.Select,{value:P.position,onValueChange:a=>V("position",a),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{placeholder:"Seleccionar"})}),(0,b.jsx)(s.SelectContent,{children:F.map(a=>(0,b.jsx)(s.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:"email",children:"Email"}),(0,b.jsx)(f.Input,{id:"email",type:"email",value:P.email,onChange:a=>V("email",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:"phone",children:"Teléfono"}),(0,b.jsx)(f.Input,{id:"phone",value:P.phone,onChange:a=>V("phone",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:"salary",children:"Salario"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),(0,b.jsx)(f.Input,{id:"salary",value:P.salary,onChange:a=>{var b;let c;return b=a.target.value,void((""===(c=(0,C.parseCurrency)(b))||/^\d*\.?\d{0,2}$/.test(c))&&V("salary",c))},placeholder:"0.00",className:"pl-7"})]}),P.salary&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,C.formatCurrency)(P.salary)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(r.Label,{htmlFor:"license",children:"Cédula Profesional"}),(0,b.jsx)(f.Input,{id:"license",value:P.license,onChange:a=>V("license",a.target.value)})]})]}),(0,b.jsxs)(q.DialogFooter,{children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>K(!1),children:"Cancelar"}),(0,b.jsx)(d.Button,{type:"submit",className:"btn-primary",children:L?"Actualizar":"Guardar"})]})]})]})})]})}a.s(["default",()=>D],84140)}];

//# sourceMappingURL=app_personal_page_jsx_ef43f2bc._.js.map