module.exports=[82520,(a,b,c)=>{"use strict";b.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},24560,(a,b,c)=>{"use strict";var d=a.r(82520);function e(){}function f(){}f.resetWarningCache=e,b.exports=function(){function a(a,b,c,e,f,g){if(g!==d){var h=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}function b(){return a}a.isRequired=a;var c={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:b,element:a,elementType:a,instanceOf:b,node:a,objectOf:b,oneOf:b,oneOfType:b,shape:b,exact:b,checkPropTypes:f,resetWarningCache:e};return c.PropTypes=c,c}},41212,(a,b,c)=>{b.exports=a.r(24560)()},46035,a=>{"use strict";var b,c=a.i(87924),d=a.i(72131),e=a.i(40695),f=a.i(3130),g=a.i(54161),h=a.i(33441);function i({plan:a,billingCycle:b,onSelectPlan:i}){let[j,k]=(0,d.useState)(!1),l="monthly"===b?a.price_monthly:a.price_yearly,m=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0}).format(l),n=a.discount_yearly,o=async()=>{k(!0);try{await i(a,b)}finally{k(!1)}};return(0,c.jsxs)(f.Card,{className:"relative flex flex-col border-2 transition-all hover:border-primary hover:shadow-xl",children:[a.name.includes("Profesional")&&(0,c.jsx)("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:(0,c.jsx)(g.Badge,{className:"bg-secondary text-secondary-foreground",children:"Más Popular"})}),(0,c.jsxs)(f.CardHeader,{className:"text-center pb-8",children:[(0,c.jsx)(f.CardTitle,{className:"text-2xl",children:a.name}),(0,c.jsx)(f.CardDescription,{className:"text-base mt-2",children:a.description})]}),(0,c.jsxs)(f.CardContent,{className:"flex-1 space-y-6",children:[(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsxs)("div",{className:"flex items-baseline justify-center gap-2",children:[(0,c.jsx)("span",{className:"text-4xl font-bold text-foreground",children:m}),(0,c.jsxs)("span",{className:"text-muted-foreground",children:["/","monthly"===b?"mes":"año"]})]}),"yearly"===b&&n>0&&(0,c.jsxs)("p",{className:"mt-2 text-sm text-secondary font-medium",children:["Ahorra ",n,"% pagando anualmente"]})]}),(0,c.jsx)("ul",{className:"space-y-3",children:a.features?.map((a,b)=>(0,c.jsxs)("li",{className:"flex items-start gap-3",children:[(0,c.jsx)(h.Check,{className:"h-5 w-5 shrink-0 text-secondary mt-0.5"}),(0,c.jsx)("span",{className:"text-sm text-muted-foreground leading-relaxed",children:a})]},b))})]}),(0,c.jsx)(f.CardFooter,{children:(0,c.jsx)(e.Button,{onClick:o,disabled:j,className:"w-full",size:"lg",children:j?"Procesando...":"Seleccionar Plan"})})]})}var j=a.i(5522),k=a.i(17171),l=a.i(46893),m=a.i(70106);let n=(0,m.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),o=(0,m.default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);function p({plan:a,billingCycle:b,onSubmit:g,onBack:h,initialData:i}){let[m,p]=(0,d.useState)(i||{firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:"",clinicName:"",clinicAddress:"",clinicPhone:"",clinicEmail:"",clinicCity:"",clinicState:"",clinicPostalCode:""}),[q,r]=(0,d.useState)(!1),[s,t]=(0,d.useState)(!1),[u,v]=(0,d.useState)({}),[w,x]=(0,d.useState)(!1);(0,d.useEffect)(()=>{i&&(console.log("[v0] Loading initial data into registration form:",i),p(i))},[i]);let y=a=>{let{name:b,value:c}=a.target;if("phone"===b||"clinicPhone"===b){let a=c.replace(/\D/g,"").slice(0,10),d={...m,[b]:a};p(d);try{localStorage.setItem("vetsystem_registration_form_data",JSON.stringify(d)),console.log("[v0] Form data auto-saved")}catch(a){console.error("[v0] Error saving form data:",a)}u[b]&&v(a=>({...a,[b]:""}));return}let d={...m,[b]:c};p(d);try{localStorage.setItem("vetsystem_registration_form_data",JSON.stringify(d))}catch(a){console.error("[v0] Error saving form data:",a)}u[b]&&v(a=>({...a,[b]:""}))},z=async()=>{try{console.log("[v0] Validating email and phone uniqueness...");let a=await fetch("/api/auth/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m.email,phone:m.phone})}),b=await a.json();if(console.log("[v0] Validation response:",b),!a.ok){let a={};return"email"===b.field?a.email=b.error:"phone"===b.field?a.phone=b.error:a.general=b.error,v(b=>({...b,...a})),!1}return!0}catch(a){return console.error("[v0] Validation error:",a),v(a=>({...a,general:"Error al validar los datos"})),!1}},A=async a=>{let b;if(a.preventDefault(),b={},m.firstName.trim()||(b.firstName="El nombre es obligatorio"),m.lastName.trim()||(b.lastName="Los apellidos son obligatorios"),m.email.trim()?/\S+@\S+\.\S+/.test(m.email)||(b.email="Correo inválido"):b.email="El correo es obligatorio",m.phone.trim()?10!==m.phone.length&&(b.phone="El teléfono debe tener 10 dígitos"):b.phone="El teléfono es obligatorio",m.password?m.password.length<6&&(b.password="La contraseña debe tener al menos 6 caracteres"):b.password="La contraseña es obligatoria",m.password!==m.confirmPassword&&(b.confirmPassword="Las contraseñas no coinciden"),m.clinicName.trim()||(b.clinicName="El nombre del consultorio es obligatorio"),m.clinicAddress.trim()||(b.clinicAddress="La dirección es obligatoria"),m.clinicPhone.trim()?10!==m.clinicPhone.length&&(b.clinicPhone="El teléfono debe tener 10 dígitos"):b.clinicPhone="El teléfono del consultorio es obligatorio",v(b),0===Object.keys(b).length){x(!0);try{if(!await z())return void x(!1);console.log("[v0] Validation passed, proceeding to payment..."),await g(m)}catch(a){console.error("[v0] Form submission error:",a),v(a=>({...a,general:"Error al procesar el formulario"}))}finally{x(!1)}}},B="monthly"===b?a.price_monthly:a.price_yearly,C=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0}).format(B);return(0,c.jsxs)(f.Card,{className:"max-w-4xl mx-auto",children:[(0,c.jsxs)(f.CardHeader,{children:[(0,c.jsx)(f.CardTitle,{children:"Crear Cuenta"}),(0,c.jsxs)(f.CardDescription,{children:["Plan seleccionado: ",(0,c.jsx)("strong",{children:a.name})," - ",C,"/","monthly"===b?"mes":"año"]})]}),(0,c.jsx)(f.CardContent,{children:(0,c.jsxs)("form",{onSubmit:A,className:"space-y-8",children:[u.general&&(0,c.jsx)("div",{className:"bg-destructive/10 text-destructive text-sm p-3 rounded-md border border-destructive/20",children:u.general}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"text-xl font-semibold mb-4 text-foreground",children:"Datos Personales"}),(0,c.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"firstName",children:"Nombre *"}),(0,c.jsx)(j.Input,{id:"firstName",name:"firstName",value:m.firstName,onChange:y,placeholder:"Juan"}),u.firstName&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.firstName})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"lastName",children:"Apellidos *"}),(0,c.jsx)(j.Input,{id:"lastName",name:"lastName",value:m.lastName,onChange:y,placeholder:"Pérez García"}),u.lastName&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.lastName})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"email",children:"Correo Electrónico *"}),(0,c.jsx)(j.Input,{id:"email",name:"email",type:"email",value:m.email,onChange:y,placeholder:"juan@ejemplo.com",className:u.email?"border-destructive":""}),u.email&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.email})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"phone",children:"Teléfono * (10 dígitos)"}),(0,c.jsx)(j.Input,{id:"phone",name:"phone",type:"tel",value:m.phone,onChange:y,placeholder:"5512345678",maxLength:"10",className:u.phone?"border-destructive":""}),u.phone&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.phone})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"password",children:"Contraseña *"}),(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)(j.Input,{id:"password",name:"password",type:q?"text":"password",value:m.password,onChange:y,placeholder:"Mínimo 6 caracteres"}),(0,c.jsx)("button",{type:"button",onClick:()=>r(!q),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:q?(0,c.jsx)(o,{className:"h-4 w-4"}):(0,c.jsx)(n,{className:"h-4 w-4"})})]}),u.password&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.password})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"confirmPassword",children:"Confirmar Contraseña *"}),(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)(j.Input,{id:"confirmPassword",name:"confirmPassword",type:s?"text":"password",value:m.confirmPassword,onChange:y,placeholder:"Confirma tu contraseña"}),(0,c.jsx)("button",{type:"button",onClick:()=>t(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:s?(0,c.jsx)(o,{className:"h-4 w-4"}):(0,c.jsx)(n,{className:"h-4 w-4"})})]}),u.confirmPassword&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.confirmPassword})]})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"text-xl font-semibold mb-4 text-foreground",children:"Datos del Consultorio"}),(0,c.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,c.jsxs)("div",{className:"space-y-2 sm:col-span-2",children:[(0,c.jsx)(k.Label,{htmlFor:"clinicName",children:"Nombre del Consultorio *"}),(0,c.jsx)(j.Input,{id:"clinicName",name:"clinicName",value:m.clinicName,onChange:y,placeholder:"Clínica Veterinaria San Francisco"}),u.clinicName&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.clinicName})]}),(0,c.jsxs)("div",{className:"space-y-2 sm:col-span-2",children:[(0,c.jsx)(k.Label,{htmlFor:"clinicAddress",children:"Dirección *"}),(0,c.jsx)(l.Textarea,{id:"clinicAddress",name:"clinicAddress",value:m.clinicAddress,onChange:y,placeholder:"Calle Principal #123, Colonia Centro",rows:2}),u.clinicAddress&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.clinicAddress})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"clinicPhone",children:"Teléfono del Consultorio * (10 dígitos)"}),(0,c.jsx)(j.Input,{id:"clinicPhone",name:"clinicPhone",type:"tel",value:m.clinicPhone,onChange:y,placeholder:"5512345678",maxLength:"10",className:u.clinicPhone?"border-destructive":""}),u.clinicPhone&&(0,c.jsx)("p",{className:"text-sm text-destructive",children:u.clinicPhone})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"clinicEmail",children:"Email del Consultorio"}),(0,c.jsx)(j.Input,{id:"clinicEmail",name:"clinicEmail",type:"email",value:m.clinicEmail,onChange:y,placeholder:"contacto@clinica.com"})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"clinicCity",children:"Ciudad"}),(0,c.jsx)(j.Input,{id:"clinicCity",name:"clinicCity",value:m.clinicCity,onChange:y,placeholder:"Ciudad de México"})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"clinicState",children:"Estado"}),(0,c.jsx)(j.Input,{id:"clinicState",name:"clinicState",value:m.clinicState,onChange:y,placeholder:"CDMX"})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)(k.Label,{htmlFor:"clinicPostalCode",children:"Código Postal"}),(0,c.jsx)(j.Input,{id:"clinicPostalCode",name:"clinicPostalCode",value:m.clinicPostalCode,onChange:y,placeholder:"01000"})]})]})]}),(0,c.jsxs)("div",{className:"flex gap-4",children:[(0,c.jsx)(e.Button,{type:"button",variant:"outline",onClick:h,className:"flex-1 bg-transparent",children:"Volver"}),(0,c.jsx)(e.Button,{type:"submit",disabled:w,className:"flex-1",children:w?"Validando...":"Continuar al Pago"})]})]})})]})}var q=a.i(41212);function r(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function s(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?r(Object(c),!0).forEach(function(b){u(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):r(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function t(a){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function u(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function v(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(a,b){var c,d,e=a&&("undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"]);if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(a){h=!0,d=a}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}}(a,b)||function(a,b){if(a){if("string"==typeof a)return w(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(a);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return w(a,b)}}(a,b)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}var x=function(a,b,c){var e=!!c,f=d.default.useRef(c);d.default.useEffect(function(){f.current=c},[c]),d.default.useEffect(function(){if(!e||!a)return function(){};var c=function(){f.current&&f.current.apply(f,arguments)};return a.on(b,c),function(){a.off(b,c)}},[e,b,a,f])},y=function(a){var b=d.default.useRef(a);return d.default.useEffect(function(){b.current=a},[a]),b.current},z=function(a){return null!==a&&"object"===t(a)},A="[object Object]",B=function a(b,c){if(!z(b)||!z(c))return b===c;var d=Array.isArray(b);if(d!==Array.isArray(c))return!1;var e=Object.prototype.toString.call(b)===A;if(e!==(Object.prototype.toString.call(c)===A))return!1;if(!e&&!d)return b===c;var f=Object.keys(b),g=Object.keys(c);if(f.length!==g.length)return!1;for(var h={},i=0;i<f.length;i+=1)h[f[i]]=!0;for(var j=0;j<g.length;j+=1)h[g[j]]=!0;var k=Object.keys(h);return k.length===f.length&&k.every(function(d){return a(b[d],c[d])})},C="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",D=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C;if(null===a||z(a)&&"function"==typeof a.elements&&"function"==typeof a.createToken&&"function"==typeof a.createPaymentMethod&&"function"==typeof a.confirmCardPayment)return a;throw Error(b)},E=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C;if(z(a)&&"function"==typeof a.then)return{tag:"async",stripePromise:Promise.resolve(a).then(function(a){return D(a,b)})};var c=D(a,b);return null===c?{tag:"empty"}:{tag:"sync",stripe:c}},F=function(a){a&&a._registerWrapper&&a.registerAppInfo&&(a._registerWrapper({name:"react-stripe-js",version:"5.3.0"}),a.registerAppInfo({name:"react-stripe-js",version:"5.3.0",url:"https://stripe.com/docs/stripe-js/react"}))},G=d.default.createContext(null);G.displayName="ElementsContext";var H=function(a,b){if(!a)throw Error("Could not find Elements context; You need to wrap the part of your app that ".concat(b," in an <Elements> provider."));return a};q.default.any,q.default.object,q.default.func.isRequired;var I=d.default.createContext(null);I.displayName="CheckoutContext",q.default.any,q.default.shape({clientSecret:q.default.oneOfType([q.default.string,q.default.instanceOf(Promise)]).isRequired,elementsOptions:q.default.object}).isRequired;var J=function(a){var b=d.default.useContext(I),c=d.default.useContext(G);if(!b)return H(c,a);if(!c)return b;throw Error("You cannot wrap the part of your app that ".concat(a," in both <CheckoutProvider> and <Elements> providers."))},K=["mode"],L=function(a,b){var c="".concat(a.charAt(0).toUpperCase()+a.slice(1),"Element"),e=b?function(a){J("mounts <".concat(c,">"));var b=a.id,e=a.className;return d.default.createElement("div",{id:b,className:e})}:function(b){var e,f=b.id,g=b.className,h=b.options,i=void 0===h?{}:h,j=b.onBlur,k=b.onFocus,l=b.onReady,m=b.onChange,n=b.onEscape,o=b.onClick,p=b.onLoadError,q=b.onLoaderStart,r=b.onNetworksChange,t=b.onConfirm,w=b.onCancel,A=b.onShippingAddressChange,C=b.onShippingRateChange,D=b.onSavedPaymentMethodRemove,E=b.onSavedPaymentMethodUpdate,F=J("mounts <".concat(c,">")),G="elements"in F?F.elements:null,H="checkoutState"in F?F.checkoutState:null,I=(null==H?void 0:H.type)==="success"||(null==H?void 0:H.type)==="loading"?H.sdk:null,L=v(d.default.useState(null),2),M=L[0],N=L[1],O=d.default.useRef(null),P=d.default.useRef(null);x(M,"blur",j),x(M,"focus",k),x(M,"escape",n),x(M,"click",o),x(M,"loaderror",p),x(M,"loaderstart",q),x(M,"networkschange",r),x(M,"confirm",t),x(M,"cancel",w),x(M,"shippingaddresschange",A),x(M,"shippingratechange",C),x(M,"savedpaymentmethodremove",D),x(M,"savedpaymentmethodupdate",E),x(M,"change",m),l&&(e="expressCheckout"===a?l:function(){l(M)}),x(M,"ready",e),d.default.useLayoutEffect(function(){if(null===O.current&&null!==P.current&&(G||I)){var b=null;if(I)switch(a){case"payment":b=I.createPaymentElement(i);break;case"address":if("mode"in i){var d=i.mode,e=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],b.indexOf(c)>=0||(e[c]=a[c]);return e}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(i,K);if("shipping"===d)b=I.createShippingAddressElement(e);else if("billing"===d)b=I.createBillingAddressElement(e);else throw Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":b=I.createExpressCheckoutElement(i);break;case"currencySelector":b=I.createCurrencySelectorElement();break;case"taxId":b=I.createTaxIdElement(i);break;default:throw Error("Invalid Element type ".concat(c,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else G&&(b=G.create(a,i));O.current=b,N(b),b&&b.mount(P.current)}},[G,I,i]);var Q=y(i);return d.default.useEffect(function(){if(O.current){var a,b,c,d=(a=i,b=Q,c=["paymentRequest"],z(a)?Object.keys(a).reduce(function(d,e){var f=!z(b)||!B(a[e],b[e]);return c.includes(e)?(f&&console.warn("Unsupported prop change: options.".concat(e," is not a mutable property.")),d):f?s(s({},d||{}),{},u({},e,a[e])):d},null):null);d&&"update"in O.current&&O.current.update(d)}},[i,Q]),d.default.useLayoutEffect(function(){return function(){if(O.current&&"function"==typeof O.current.destroy)try{O.current.destroy(),O.current=null}catch(a){}}},[]),d.default.createElement("div",{id:f,className:g,ref:P})};return e.propTypes={id:q.default.string,className:q.default.string,onChange:q.default.func,onBlur:q.default.func,onFocus:q.default.func,onReady:q.default.func,onEscape:q.default.func,onClick:q.default.func,onLoadError:q.default.func,onLoaderStart:q.default.func,onNetworksChange:q.default.func,onConfirm:q.default.func,onCancel:q.default.func,onShippingAddressChange:q.default.func,onShippingRateChange:q.default.func,onSavedPaymentMethodRemove:q.default.func,onSavedPaymentMethodUpdate:q.default.func,options:q.default.object},e.displayName=c,e.__elementType=a,e},M=d.default.createContext(null);M.displayName="EmbeddedCheckoutProviderContext";var N=function(){var a=d.default.useContext(M);if(!a)throw Error("<EmbeddedCheckout> must be used within <EmbeddedCheckoutProvider>");return a},O=function(a){var b=a.stripe,c=a.options,e=a.children,f=d.default.useMemo(function(){return E(b,"Invalid prop `stripe` supplied to `EmbeddedCheckoutProvider`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.")},[b]),g=d.default.useRef(null),h=d.default.useRef(null),i=v(d.default.useState({embeddedCheckout:null}),2),j=i[0],k=i[1];d.default.useEffect(function(){if(!h.current&&!g.current){var a=function(a){h.current||g.current||(h.current=a,g.current=h.current.initEmbeddedCheckout(c).then(function(a){k({embeddedCheckout:a})}))};"async"===f.tag&&!h.current&&(c.clientSecret||c.fetchClientSecret)?f.stripePromise.then(function(b){b&&a(b)}):"sync"===f.tag&&!h.current&&(c.clientSecret||c.fetchClientSecret)&&a(f.stripe)}},[f,c,j,h]),d.default.useEffect(function(){return function(){j.embeddedCheckout?(g.current=null,j.embeddedCheckout.destroy()):g.current&&g.current.then(function(){g.current=null,j.embeddedCheckout&&j.embeddedCheckout.destroy()})}},[j.embeddedCheckout]),d.default.useEffect(function(){F(h)},[h]);var l=y(b);d.default.useEffect(function(){null!==l&&l!==b&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the `stripe` prop after setting it.")},[l,b]);var m=y(c);return d.default.useEffect(function(){if(null!=m){if(null==c)return void console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot unset options after setting them.");void 0===c.clientSecret&&void 0===c.fetchClientSecret&&console.warn("Invalid props passed to EmbeddedCheckoutProvider: You must provide one of either `options.fetchClientSecret` or `options.clientSecret`."),null!=m.clientSecret&&c.clientSecret!==m.clientSecret&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the client secret after setting it. Unmount and create a new instance of EmbeddedCheckoutProvider instead."),null!=m.fetchClientSecret&&c.fetchClientSecret!==m.fetchClientSecret&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change fetchClientSecret after setting it. Unmount and create a new instance of EmbeddedCheckoutProvider instead."),null!=m.onComplete&&c.onComplete!==m.onComplete&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onComplete option after setting it."),null!=m.onShippingDetailsChange&&c.onShippingDetailsChange!==m.onShippingDetailsChange&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onShippingDetailsChange option after setting it."),null!=m.onLineItemsChange&&c.onLineItemsChange!==m.onLineItemsChange&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onLineItemsChange option after setting it.")}},[m,c]),d.default.createElement(M.Provider,{value:j},e)},P=function(a){var b=a.id,c=a.className;return N(),d.default.createElement("div",{id:b,className:c})};L("auBankAccount",!0),L("card",!0),L("cardNumber",!0),L("cardExpiry",!0),L("cardCvc",!0),L("iban",!0),L("payment",!0),L("expressCheckout",!0),L("paymentRequestButton",!0),L("linkAuthentication",!0),L("address",!0),L("shippingAddress",!0),L("paymentMethodMessaging",!0),L("taxId",!0);var Q="clover";"".concat("https://js.stripe.com","/").concat(Q,"/stripe.js");var R=function(a,b){a&&a._registerWrapper&&a._registerWrapper({name:"stripe-js",version:"8.4.0",startTime:b})},S=null,T=function(a,b,c){if(null===a)return null;var d,e=b[0].match(/^pk_test/),f=3===(d=a.version)?"v3":d;e&&f!==Q&&console.warn("Stripe.js@".concat(f," was loaded on the page, but @stripe/stripe-js@").concat("8.4.0"," expected Stripe.js@").concat(Q,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var g=a.apply(void 0,b);return R(g,c),g},U=!1,V=function(){return b?b:b=(null!==S?S:(S=new Promise(function(a,b){a(null)})).catch(function(a){return S=null,Promise.reject(a)})).catch(function(a){return b=null,Promise.reject(a)})};Promise.resolve().then(function(){return V()}).catch(function(a){U||console.warn(a)});var W=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];U=!0;var d=Date.now();return V().then(function(a){return T(a,b,d)})};let X=null;function Y({plan:a,billingCycle:b,userData:g,onBack:h,onSuccess:i}){let[j,k]=(0,d.useState)(null),[l,m]=(0,d.useState)(null),[n,o]=(0,d.useState)(null),[p,q]=(0,d.useState)(null),[r,s]=(0,d.useState)(!1),[t,u]=(0,d.useState)(null);(0,d.useEffect)(()=>{let a=function(){let a;if(X)return X;let b=(console.log("[v0] Stripe publishable key found:",(a="pk_test_51ST2k31LGdPqIkO0qS3fzHRz8oHuAM38jebS06xhMX0NtTqrfwj1qbR3BKFZmVpwQHBtBNhcCjeRa8mjohqyGY3M00u4gZ5Ij9").substring(0,20)+"..."),a);if(!b)return console.error("[v0] Cannot initialize Stripe: No publishable key found"),null;try{X=W(b),console.log("[v0] Stripe initialized successfully")}catch(a){return console.error("[v0] Error loading Stripe:",a),null}return X}();a?q(a):o("La configuración de Stripe no está disponible. Por favor verifica que la integración esté correctamente configurada.")},[]);let v=(0,d.useCallback)(async()=>{try{console.log("[v0] Creating checkout session..."),console.log("[v0] Plan:",a),console.log("[v0] Billing cycle:",b);let c=a.stripe_id;console.log("[v0] Product ID:",c);let d=await fetch("/api/stripe/create-checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:c,userData:g})}),e=await d.json();if(console.log("[v0] Checkout API response:",e),!d.ok)throw Error(e.error||"Error al crear sesión de pago");console.log("[v0] Checkout session created successfully");let f=e.clientSecret.split("_secret_")[0];return m(f),e.clientSecret}catch(a){return console.error("[v0] Error fetching client secret:",a),o(a.message),null}},[a,b,g]);(0,d.useEffect)(()=>{p&&v().then(a=>{a&&k(a)})},[v,p]),(0,d.useEffect)(()=>{if(!l||r)return;let a=setInterval(async()=>{try{console.log("[v0] Checking payment status for session:",l);let a=await fetch("/api/stripe/check-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:l})}),b=await a.json();if(console.log("[v0] Payment status response:",b),"expired"===b.status||"canceled"===b.status){u("La sesión de pago ha expirado o fue cancelada. Por favor intenta nuevamente."),s(!0);return}if("unpaid"===b.payment_status&&b.last_error){let a=w(b.last_error);u(a),s(!0);return}if("paid"===b.payment_status&&"complete"===b.status){console.log("[v0] Payment succeeded! Registering user..."),s(!0);let a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),b=await a.json();console.log("[v0] Registration response:",b),b.success?(console.log("[v0] User registered successfully:",b.data),localStorage.removeItem("vetsystem_registration_form_data"),i&&i(g.firstName)):(console.error("[v0] Registration failed:",b.error),u(`Error al completar el registro: ${b.error}. Por favor contacta soporte.`))}}catch(a){console.error("[v0] Error checking payment status:",a),u("Error al verificar el estado del pago. Por favor contacta soporte.")}},2e3);return()=>clearInterval(a)},[l,g,r,i]);let w=a=>a?({card_declined:"Tu tarjeta fue rechazada. Por favor intenta con otra tarjeta.",insufficient_funds:"Fondos insuficientes. Por favor verifica el saldo de tu tarjeta.",expired_card:"Tu tarjeta ha expirado. Por favor usa una tarjeta válida.",incorrect_cvc:"El código de seguridad (CVC) es incorrecto.",processing_error:"Error al procesar el pago. Por favor intenta nuevamente.",incorrect_number:"El número de tarjeta es incorrecto.",invalid_expiry_month:"El mes de vencimiento es inválido.",invalid_expiry_year:"El año de vencimiento es inválido.",authentication_required:"Tu banco requiere autenticación adicional. Por favor completa la verificación."})[a.code||a.decline_code]||a.message||"Error al procesar el pago. Por favor intenta nuevamente.":"Error desconocido en el pago.";return(0,d.useEffect)(()=>{t&&alert(t)},[t]),(0,c.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,c.jsx)(e.Button,{onClick:h,variant:"outline",children:"Volver"}),n?(0,c.jsxs)(f.Card,{children:[(0,c.jsxs)(f.CardHeader,{children:[(0,c.jsx)(f.CardTitle,{children:"Error de Configuración"}),(0,c.jsx)(f.CardDescription,{children:"Hubo un problema al inicializar el sistema de pagos"})]}),(0,c.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,c.jsx)("p",{className:"text-destructive",children:n}),(0,c.jsxs)("div",{className:"bg-muted p-4 rounded-lg text-sm",children:[(0,c.jsx)("p",{className:"font-semibold mb-2",children:"Información técnica:"}),(0,c.jsxs)("p",{children:["Si eres el administrador del sistema, verifica que la variable de entorno"," ",(0,c.jsx)("code",{className:"bg-background px-2 py-1 rounded",children:"NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY"})," esté configurada correctamente en tu proyecto de Vercel."]})]})]})]}):j&&p?(0,c.jsx)("div",{id:"checkout",children:(0,c.jsx)(O,{stripe:p,options:{clientSecret:j},children:(0,c.jsx)(P,{})})}):(0,c.jsx)(f.Card,{children:(0,c.jsx)(f.CardContent,{className:"py-12",children:(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4",children:[(0,c.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"}),(0,c.jsx)("p",{className:"text-muted-foreground",children:"Preparando formulario de pago..."})]})})})]})}var Z=a.i(83563),$=a.i(84930),_=a.i(16201),aa=a.i(38246);function ab({userName:a}){return(0,c.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,c.jsxs)(f.Card,{className:"border-secondary",children:[(0,c.jsxs)(f.CardHeader,{className:"text-center space-y-4 pb-6",children:[(0,c.jsx)("div",{className:"mx-auto w-16 h-16 bg-secondary/10 rounded-full flex items-center justify-center",children:(0,c.jsx)(_.CheckCircle,{className:"w-10 h-10 text-secondary"})}),(0,c.jsx)(f.CardTitle,{className:"text-3xl",children:"¡Compra Exitosa!"})]}),(0,c.jsxs)(f.CardContent,{className:"space-y-6 text-center",children:[(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("p",{className:"text-xl font-semibold",children:["¡Bienvenido al equipo, ",a,"!"]}),(0,c.jsx)("p",{className:"text-muted-foreground text-pretty leading-relaxed",children:"Tu cuenta ha sido creada exitosamente y tu pago ha sido procesado. Ya puedes comenzar a administrar tu clínica veterinaria con todas las herramientas que te ofrecemos."})]}),(0,c.jsxs)("div",{className:"bg-muted/50 rounded-lg p-6 space-y-3 text-sm",children:[(0,c.jsx)("p",{className:"font-semibold",children:"¿Qué sigue?"}),(0,c.jsxs)("ul",{className:"text-left space-y-2 max-w-md mx-auto",children:[(0,c.jsxs)("li",{className:"flex items-start gap-2",children:[(0,c.jsx)("span",{className:"text-secondary mt-0.5",children:"•"}),(0,c.jsx)("span",{children:"Inicia sesión con tu correo y contraseña"})]}),(0,c.jsxs)("li",{className:"flex items-start gap-2",children:[(0,c.jsx)("span",{className:"text-secondary mt-0.5",children:"•"}),(0,c.jsx)("span",{children:"Configura los detalles de tu consultorio"})]}),(0,c.jsxs)("li",{className:"flex items-start gap-2",children:[(0,c.jsx)("span",{className:"text-secondary mt-0.5",children:"•"}),(0,c.jsx)("span",{children:"Comienza a gestionar pacientes y consultas"})]}),(0,c.jsxs)("li",{className:"flex items-start gap-2",children:[(0,c.jsx)("span",{className:"text-secondary mt-0.5",children:"•"}),(0,c.jsx)("span",{children:"Explora todas las funcionalidades del sistema"})]})]})]}),(0,c.jsx)("div",{className:"pt-4",children:(0,c.jsx)(aa.default,{href:"/login",children:(0,c.jsx)(e.Button,{size:"lg",className:"w-full sm:w-auto px-8",children:"Iniciar Sesión"})})}),(0,c.jsx)("p",{className:"text-xs text-muted-foreground"})]})]})})}let ac="vetsystem_registration_form_data";function ad(){let[a,b]=(0,d.useState)([]),[f,g]=(0,d.useState)(!0),[j,k]=(0,d.useState)("monthly"),[l,m]=(0,d.useState)("plans"),[n,o]=(0,d.useState)(null),[q,r]=(0,d.useState)(null),[s,t]=(0,d.useState)(null),[u,v]=(0,d.useState)(!1),[w,x]=(0,d.useState)("");(0,d.useEffect)(()=>{let a=localStorage.getItem(ac);if(a)try{let b=JSON.parse(a);t(b),console.log("[v0] Loaded saved form data from localStorage:",b)}catch(a){console.error("[v0] Error parsing saved form data:",a)}},[]),(0,d.useEffect)(()=>{!async function(){try{let a=await fetch("/api/plans"),c=await a.json();b(c.plans||[])}catch(a){console.error("[v0] Error loading plans:",a)}finally{g(!1)}}()},[]);let y=async(a,b)=>{o(a),k(b),m("register")},z=async a=>{console.log("[v0] Saving registration data for payment:",a),r(a),m("checkout")};return f?(0,c.jsx)("div",{className:"container mx-auto px-4 py-20",children:(0,c.jsx)("div",{className:"flex items-center justify-center",children:(0,c.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})})}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Z.LandingNavbar,{}),(0,c.jsx)("div",{className:"container mx-auto px-4 py-12 md:py-20",children:u?(0,c.jsx)(ab,{userName:w}):(0,c.jsxs)(c.Fragment,{children:["plans"===l&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"mx-auto max-w-3xl text-center mb-12",children:[(0,c.jsx)("h1",{className:"text-4xl font-bold text-balance text-foreground mb-4",children:"Planes y Precios"}),(0,c.jsx)("p",{className:"text-lg text-muted-foreground text-pretty leading-relaxed",children:"Elige el plan que mejor se adapte a las necesidades de tu clínica veterinaria. Todos los planes incluyen 14 días de prueba gratuita."})]}),(0,c.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-12",children:[(0,c.jsx)(e.Button,{variant:"monthly"===j?"default":"outline",onClick:()=>k("monthly"),children:"Mensual"}),(0,c.jsxs)(e.Button,{variant:"yearly"===j?"default":"outline",onClick:()=>k("yearly"),className:"relative",children:["Anual",(0,c.jsx)("span",{className:"absolute -top-3 -right-3 rounded-full bg-secondary px-2 py-0.5 text-xs text-secondary-foreground",children:"Ahorra 17%"})]})]}),(0,c.jsx)("div",{className:"grid gap-8 md:grid-cols-3 max-w-6xl mx-auto mb-16",children:a.map(a=>(0,c.jsx)(i,{plan:a,billingCycle:j,onSelectPlan:y},a.stripe_id))}),(0,c.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,c.jsx)("h2",{className:"text-2xl font-bold text-center mb-8",children:"Lo que Incluyen Todos los Planes"}),(0,c.jsx)("div",{className:"grid gap-4 sm:grid-cols-2",children:["Actualizaciones automáticas","Soporte técnico","Respaldo diario de información","Seguridad SSL","Acceso desde cualquier dispositivo","Reportes y estadísticas"].map((a,b)=>(0,c.jsxs)("div",{className:"flex items-center gap-3 text-muted-foreground",children:[(0,c.jsx)(h.Check,{className:"h-5 w-5 text-secondary shrink-0"}),(0,c.jsx)("span",{children:a})]},b))})]})]}),"register"===l&&n&&(0,c.jsx)(p,{plan:n,billingCycle:j,onSubmit:z,onBack:()=>m("plans"),initialData:s}),"checkout"===l&&n&&q&&(0,c.jsx)(Y,{plan:n,billingCycle:j,userData:q,onBack:()=>{let a=localStorage.getItem(ac);if(a)try{let b=JSON.parse(a);t(b),console.log("[v0] Reloaded form data when going back:",b)}catch(a){console.error("[v0] Error reloading form data:",a)}m("register")},onSuccess:a=>{x(a),v(!0)}})]})}),(0,c.jsx)($.LandingFooter,{})]})}a.s(["default",()=>ad],46035)}];

//# sourceMappingURL=_b629352a._.js.map